# INSTALL SCAPY BEFORE
# sudo apt install python3-scapy

# Usage example

# python script.py -i eth0 -r 10.10.X.X/24 -b ff:ff:ff:ff:ff:ff

from scapy.all import *
import argparse

def arp_scan(interface, ip_range, broadcast_mac):
    packet = Ether(dst=broadcast_mac) / ARP(pdst=ip_range)
    ans, unans = srp(packet, timeout=2, iface=interface, inter=0.1)
    
    for send, receive in ans:
        print(receive.sprintf(r"%Ether.src% - %ARP.psrc%"))

# Parse the command-line arguments
parser = argparse.ArgumentParser(description="ARP Scanner")
parser.add_argument("-i", "--interface", help="Network interface to use")
parser.add_argument("-r", "--ip-range", help="IP range to scan")
parser.add_argument("-b", "--broadcast-mac", help="Broadcast MAC address")
args = parser.parse_args()

if not args.interface or not args.ip_range or not args.broadcast_mac:
    parser.print_help()
    parser.exit(1)

arp_scan(args.interface, args.ip_range, args.broadcast_mac)
